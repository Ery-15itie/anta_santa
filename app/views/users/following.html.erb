<%# フォロー中のフレンド一覧: 木製レターラック風 %>

<div class="min-h-screen bg-[#3e2723] font-serif pb-20 relative overflow-x-hidden text-[#3e2723]">
  
  <%# 背景テクスチャ（木目） %>
  <div class="fixed inset-0 opacity-20 pointer-events-none" 
       style="background-image: repeating-linear-gradient(45deg, #3e2723 25%, #4e342e 25%, #4e342e 50%, #3e2723 50%, #3e2723 75%, #4e342e 75%, #4e342e 100%); background-size: 20px 20px;">
  </div>

  <div class="container mx-auto px-4 py-8 max-w-4xl relative z-10">

    <%# --- 1. 戻るボタン (木の矢印看板) --- %>
    <div class="mb-8 text-center relative">
       <%= link_to users_path, class: "inline-block group relative" do %>
         <%# 鎖 %>
         <div class="absolute -top-12 left-1/2 transform -translate-x-1/2 w-0.5 h-12 bg-[#8d6e63]"></div>
         
         <%# 看板本体 %>
         <div class="bg-[#5d4037] border-2 border-[#3e2723] px-6 py-2 rounded shadow-lg transform group-hover:-translate-y-1 transition duration-300 flex items-center gap-2">
           <span class="text-[#ffecb3] text-lg">←</span>
           <span class="text-[#ffecb3] font-bold text-sm tracking-widest">ADDRESS BOOK</span>
         </div>
       <% end %>
    </div>

    <%# --- 2. レターラック (メインコンテナ) --- %>
    <div class="bg-[#4e342e] p-2 rounded-t-lg shadow-2xl border-x-8 border-t-8 border-[#3e2723] relative">
      
      <%# タイトルプレート (真鍮風) %>
      <div class="bg-[#ffecb3] mx-auto w-3/4 sm:w-1/2 py-3 rounded-sm shadow-inner text-center mb-6 border-4 border-[#d7ccc8] transform -translate-y-6 relative">
        <div class="absolute top-2 left-2 w-2 h-2 rounded-full bg-[#3e2723] opacity-50"></div>
        <div class="absolute top-2 right-2 w-2 h-2 rounded-full bg-[#3e2723] opacity-50"></div>
        <h1 class="text-2xl font-black text-[#3e2723] tracking-widest uppercase" style="font-family: 'Courier New', Courier, monospace;">
          Friend List
        </h1>
        <p class="text-[10px] text-[#5d4037] font-bold uppercase tracking-widest">Following Users</p>
      </div>

      <%# リストエリア (ラックの中身) %>
      <div class="space-y-3 px-2 pb-6">
        
        <% if @users.empty? %>
          <%# 空の状態 %>
          <div class="text-center py-12 bg-[#3e2723] bg-opacity-30 rounded border-2 border-dashed border-[#8d6e63]">
            <p class="text-lg font-bold text-[#d7ccc8] opacity-50 mb-2">Rack is empty</p>
            <p class="text-sm text-[#a1887f]">まだ誰もフォローしていません。<br>一覧から仲間を見つけましょう。</p>
          </div>
        <% else %>
          
          <% @users.each do |user| %>
            <%# ユーザーカード (インデックスカード風) %>
            <div class="relative bg-[#fdf6e3] p-4 rounded shadow-md transform hover:-translate-y-0.5 transition duration-200 flex items-center justify-between group border-b-4 border-[#d7ccc8]">
              
              <%# 左端のインデックスカラー %>
              <div class="absolute left-0 top-0 bottom-0 w-2 bg-[#8d6e63] rounded-l"></div>
              
              <%# 罫線テクスチャ %>
              <div class="absolute inset-0 opacity-10 pointer-events-none rounded" 
                   style="background-image: linear-gradient(#000 1px, transparent 1px); background-size: 100% 1.5rem;">
              </div>

              <div class="flex items-center pl-4 relative z-10">
                <div class="w-12 h-12 rounded-full bg-[#efebe9] border-2 border-dotted border-[#5d4037] flex items-center justify-center text-[#3e2723] text-lg font-bold mr-4 shadow-sm">
                  <%= user.username.to_s[0].upcase %>
                </div>
                
                <div>
                  <%# ユーザー名 %>
                  <%= link_to user.username, user_path(user), class: "text-lg font-bold text-[#3e2723] hover:text-[#d32f2f] transition font-serif border-b border-transparent hover:border-[#d32f2f]" %>
                  <p class="text-xs text-[#8d6e63] mt-0.5">Friend</p>
                </div>
              </div>

              <%# アクションボタン %>
              <div class="relative z-10">
                <%# 【重要】 data: { turbo: false } を追加 %>
                <%= link_to new_evaluation_path(receiver_id: user.id), 
                    class: 'flex items-center gap-2 px-4 py-2 bg-[#5d4037] text-[#ffecb3] text-xs sm:text-sm font-bold rounded shadow hover:bg-[#3e2723] transition border border-[#3e2723]',
                    data: { turbo: false } do %>
                    <span>✉️ お手紙を送る</span>
                <% end %>
              </div>

            </div>
          <% end %>
        <% end %>
      </div>
    </div>
    
    <%# ラックの下部装飾 %>
    <div class="h-4 bg-[#3e2723] rounded-b-lg mx-4 opacity-50"></div>

  </div>
</div>