<%# 新規登録画面: Anta-Santa村への入り口 (Village Entrance Style - Complete Guide) %>

<div class="min-h-screen bg-[#271c19] font-serif pb-20 relative overflow-x-hidden text-[#3e2723]">
  
  <%# 背景: 夜の森と村の雰囲気 %>
  <div class="fixed inset-0 opacity-60 pointer-events-none" 
       style="background-image: radial-gradient(circle at 50% 30%, #4e342e 0%, #271c19 70%);">
  </div>
  <%# 雪のエフェクト %>
  <div class="fixed inset-0 opacity-20 pointer-events-none"
       style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMCIgaGVpZ2h0PSIxMCI+CjxjaXJjbGUgY3g9IjUiIGN5PSI1IiByPSIxIiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9IjAuNSIvPgo8L3N2Zz4='); background-size: 100px 100px;">
  </div>

  <div class="container mx-auto px-4 py-12 max-w-5xl relative z-10 flex flex-col items-center justify-center">
    
    <%# --- 1. 新規登録エリア (暖炉と扉) --- %>
    <div class="w-full bg-white rounded-2xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden mb-16 flex flex-col md:flex-row min-h-[600px] border-4 border-[#3e2723]">
      
      <%# 左側: 入力フォーム %>
      <div class="w-full md:w-1/2 p-8 sm:p-12 flex flex-col justify-center bg-[#fff8e1] relative">
        <div class="text-center mb-8">
          <h2 class="text-3xl font-black text-[#3e2723] tracking-widest mb-2" style="font-family: 'Courier New', Courier, monospace;">
            Sign Up
          </h2>
          <p class="text-xs text-[#8d6e63] font-bold uppercase tracking-wider">新しいサンタさんとして登録</p>
        </div>

        <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { class: "space-y-5", data: { turbo: false } }) do |f| %>
          <%= render "devise/shared/error_messages", resource: resource %>

          <div>
            <%= f.label :username, "お名前 (ニックネーム)", class: "block text-xs font-bold text-[#e65100] mb-1" %>
            <%= f.text_field :username, autofocus: true, autocomplete: "username", placeholder: "サンタ 太郎",
                class: "w-full bg-white border border-[#ffcc80] text-[#3e2723] px-4 py-3 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#ef6c00] focus:border-transparent transition" %>
          </div>

          <div>
            <%= f.label :email, "メールアドレス", class: "block text-xs font-bold text-[#e65100] mb-1" %>
            <%= f.email_field :email, autocomplete: "email", placeholder: "santa@example.com",
                class: "w-full bg-white border border-[#ffcc80] text-[#3e2723] px-4 py-3 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#ef6c00] focus:border-transparent transition" %>
          </div>

          <div>
            <%= f.label :password, "パスワード", class: "block text-xs font-bold text-[#e65100] mb-1" %>
            <% if @minimum_password_length %>
              <span class="text-[10px] text-[#a1887f]">(<%= @minimum_password_length %>文字以上)</span>
            <% end %>
            <%= f.password_field :password, autocomplete: "new-password", placeholder: "••••••••",
                class: "w-full bg-white border border-[#ffcc80] text-[#3e2723] px-4 py-3 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#ef6c00] focus:border-transparent transition" %>
          </div>

          <div>
            <%= f.label :password_confirmation, "パスワード (確認)", class: "block text-xs font-bold text-[#e65100] mb-1" %>
            <%= f.password_field :password_confirmation, autocomplete: "new-password", placeholder: "••••••••",
                class: "w-full bg-white border border-[#ffcc80] text-[#3e2723] px-4 py-3 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-[#ef6c00] focus:border-transparent transition" %>
          </div>

          <div class="pt-4">
            <%= f.submit "扉を開ける (登録)", 
                class: "w-full py-3 px-4 bg-gradient-to-r from-[#ef6c00] to-[#c62828] text-white font-bold rounded-full shadow-lg hover:from-[#f57c00] hover:to-[#d32f2f] hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-200 cursor-pointer border-2 border-[#fff3e0]" %>
          </div>
        <% end %>

        <%# ▼▼▼ Googleボタンエリア ▼▼▼ %>
        <div class="mt-6 text-center">
          <p class="text-xs text-[#8d6e63] mb-3 font-bold">—— または ——</p>
          <div class="w-full">
            <%# Tailwind CSSに合わせたスタイル + 下線(underline)を追加 %>
            <%= button_to "Googleアカウントで登録", 
                user_google_oauth2_omniauth_authorize_path, 
                method: :post, 
                data: { turbo: false }, 
                class: "w-full py-3 px-4 bg-white border-2 border-[#8d6e63] text-[#5d4037] font-bold rounded-full shadow-sm hover:bg-[#d7ccc8] transition duration-200 cursor-pointer underline" %>
          </div>
        </div>
        <%# ▲▲▲ ここまで ▲▲▲ %>

        <div class="mt-6 text-center pt-4 border-t border-[#ffe0b2]">
          <p class="text-xs text-[#8d6e63] mb-2">すでに住民登録がお済みですか？</p>
          <%= link_to "ログインはこちら", new_session_path(resource_name), class: "text-[#e65100] font-bold hover:text-[#bf360c] hover:underline" %>
        </div>
      </div>

      <%# 右側: ウェルカムビジュアル %>
      <div class="w-full md:w-1/2 p-10 lg:p-16 flex flex-col justify-center items-center text-center relative overflow-hidden text-white"
           style="background: linear-gradient(135deg, #d84315 0%, #ef6c00 50%, #ff9800 100%);">
        <div class="absolute top-0 left-0 w-full h-full bg-black opacity-10 mix-blend-overlay"></div>
        <div class="relative z-10">
          <div class="text-6xl mb-6 drop-shadow-md animate-pulse">🔥</div>
          <h1 class="text-3xl lg:text-4xl font-black mb-4 drop-shadow-md">
            Welcome to<br>Anta-Santa Village
          </h1>
          <p class="text-lg font-medium opacity-90 leading-relaxed">
            ここは、一年中クリスマスが続く村<br>
            温かい暖炉の火が、<br>
            あなたの帰りを待っています
          </p>
        </div>
      </div>
    </div>

    <%# --- 2. 共通コンテンツ (パーシャル読み込み) --- %>
    <%= render "devise/shared/village_guide" %>

  </div>
</div>